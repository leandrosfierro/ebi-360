<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formato Excel para Encuestas</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        @page {
            size: A4;
            margin: 2cm;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.7;
            color: #1f2937;
            background: linear-gradient(135deg, #a855f7 0%, #764ba2 100%);
            padding: 2rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
            overflow: hidden;
        }
        
        .cover {
            background: #a855f7;
            background: linear-gradient(135deg, #a855f7 0%, #764ba2 100%);
            color: white;
            padding: 5rem 3rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .cover::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 15s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .cover-content {
            position: relative;
            z-index: 1;
        }
        
        .logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 2rem;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 900;
            color: #a855f7;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .cover h1 {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 1rem;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
            letter-spacing: -0.02em;
        }
        
        .cover .subtitle {
            font-size: 1.5rem;
            opacity: 0.95;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .cover .version {
            font-size: 1rem;
            opacity: 0.85;
            margin-top: 2rem;
            font-weight: 500;
        }
        
        .content {
            padding: 4rem 3rem;
        }
        
        h1, h2, h3, h4, h5, h6 {
            color: #111827;
            margin-top: 2.5rem;
            margin-bottom: 1.25rem;
            font-weight: 700;
            line-height: 1.3;
        }
        
        h1 { 
            font-size: 2.5rem; 
            border-bottom: 4px solid #a855f7; 
            padding-bottom: 0.75rem;
            margin-top: 3rem;
        }
        
        h2 { 
            font-size: 2rem; 
            color: #a855f7;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        h2::before {
            content: '';
            width: 6px;
            height: 2rem;
            background: #a855f7;
            border-radius: 3px;
        }
        
        h3 { 
            font-size: 1.5rem;
            color: #374151;
        }
        
        h4 {
            font-size: 1.25rem;
            color: #4b5563;
        }
        
        p {
            margin-bottom: 1.25rem;
            text-align: justify;
        }
        
        ul, ol {
            margin-left: 2.5rem;
            margin-bottom: 1.5rem;
        }
        
        li {
            margin-bottom: 0.75rem;
            line-height: 1.6;
        }
        
        li.checkbox {
            list-style: none;
            margin-left: -1.5rem;
        }
        
        li.checkbox.checked {
            color: #10b981;
            font-weight: 600;
        }
        
        code {
            background: #f3f4f6;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            color: #be123c;
            border: 1px solid #e5e7eb;
        }
        
        pre {
            background: #1f2937;
            color: #f3f4f6;
            padding: 2rem;
            border-radius: 16px;
            overflow-x: auto;
            margin: 2rem 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid #374151;
        }
        
        pre code {
            background: none;
            color: inherit;
            padding: 0;
            border: none;
        }
        
        blockquote {
            border-left: 5px solid #a855f7;
            padding: 1.5rem 2rem;
            margin: 2rem 0;
            background: #f9fafb;
            border-radius: 0 12px 12px 0;
            font-style: italic;
            color: #374151;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 2rem 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        th, td {
            padding: 1rem 1.5rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        
        th {
            background: linear-gradient(135deg, #a855f7 0%, #764ba2 100%);
            color: white;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
        }
        
        tr:hover {
            background: #f9fafb;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        .toc {
            background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
            padding: 2.5rem;
            border-radius: 16px;
            margin: 2rem 0;
            border: 2px solid #e5e7eb;
        }
        
        .toc h2 {
            margin-top: 0;
            color: #a855f7;
        }
        
        .toc ul {
            list-style: none;
            margin-left: 0;
        }
        
        .toc li {
            padding: 0.5rem 0;
        }
        
        .toc a {
            color: #a855f7;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .toc a:hover {
            transform: translateX(8px);
            color: #764ba2;
        }
        
        .info-box {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-left: 5px solid #3b82f6;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        
        .success-box {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border-left: 5px solid #10b981;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 5px solid #f59e0b;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        
        .danger-box {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-left: 5px solid #ef4444;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
        }
        
        .footer {
            background: #f9fafb;
            padding: 3rem;
            text-align: center;
            color: #6b7280;
            font-size: 0.9rem;
            border-top: 3px solid #a855f7;
        }
        
        .footer strong {
            color: #a855f7;
        }
        
        .print-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: #a855f7;
            color: white;
            padding: 1rem 2rem;
            border-radius: 50px;
            border: none;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .print-button:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.4);
        }
        
        .diagram {
            background: #1f2937;
            color: #f3f4f6;
            padding: 2rem;
            border-radius: 16px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.4;
            overflow-x: auto;
            margin: 2rem 0;
            white-space: pre;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                border-radius: 0;
                max-width: 100%;
            }
            
            .print-button {
                display: none;
            }
            
            .cover {
                page-break-after: always;
            }
            
            h1, h2, h3 {
                page-break-after: avoid;
            }
            
            pre, table, .diagram {
                page-break-inside: avoid;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 0;
            }
            
            .container {
                border-radius: 0;
            }
            
            .cover {
                padding: 3rem 1.5rem;
            }
            
            .cover h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 2rem 1.5rem;
            }
            
            h1 {
                font-size: 1.75rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <button class="print-button" onclick="window.print()">ğŸ–¨ï¸ Imprimir / Guardar PDF</button>
    
    <div class="container">
        <div class="cover">
            <div class="cover-content">
                <div class="logo">ğŸ“‹</div>
                <h1>Formato Excel para Encuestas</h1>
                <p class="subtitle">GuÃ­a de Uso y ValidaciÃ³n</p>
                <p class="version">VersiÃ³n 1.0 â€¢ December 2025</p>
            </div>
        </div>
        
        <div class="content">
            <h1>ğŸ“‹ Plantilla de Excel para Encuestas - EBI 360</h1>
<h2>GuÃ­a de Uso y Formato</h2>
<br>
<p>---</p>
<br>
<h2>ğŸ“„ Estructura del Archivo</h2>
<br>
<p>El archivo Excel debe tener <strong>3 hojas</strong> obligatorias:</p>
<br>
<ol>
<li><strong>Metadata</strong> - InformaciÃ³n general de la encuesta</li>
<li><strong>Questions</strong> - Listado de preguntas</li>
<li><strong>Algorithm</strong> - ConfiguraciÃ³n del algoritmo de cÃ¡lculo</li>
</ol>
<br>
<p>---</p>
<br>
<h2>ğŸ“Š Hoja 1: "Metadata"</h2>
<br>
<h3>Formato</h3>
<br>
<p>| Campo | Valor | Tipo | Obligatorio | DescripciÃ³n |</p>
<p>|-------|-------|------|-------------|-------------|</p>
<p>| CÃ³digo | NOM035 | Texto | âœ… | CÃ³digo Ãºnico (sin espacios, mayÃºsculas) |</p>
<p>| Nombre | NOM-035 STPS 2018 | Texto | âœ… | Nombre completo de la encuesta |</p>
<p>| DescripciÃ³n | IdentificaciÃ³n y anÃ¡lisis de factores de riesgo psicosocial | Texto | âœ… | DescripciÃ³n breve |</p>
<p>| Tipo | regulatory | Texto | âœ… | base / regulatory / custom |</p>
<p>| PaÃ­s | MX | Texto | âŒ | CÃ³digo ISO 2 letras (MX, CL, AR, etc.) |</p>
<p>| Normativa | NOM-035-STPS-2018 | Texto | âŒ | Nombre oficial de la normativa |</p>
<p>| VersiÃ³n | 1.0 | Texto | âœ… | VersiÃ³n de la encuesta |</p>
<p>| Es Base | NO | SI/NO | âœ… | Solo SI para EBI360 |</p>
<p>| Es Obligatoria | SI | SI/NO | âœ… | Si es obligatoria para empresas |</p>
<br>
<h3>Ejemplo Real</h3>
<br>
<p>``<code></p>
<p>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</p>
<p>â”‚ Campo           â”‚ Valor                                             â”‚</p>
<p>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</p>
<p>â”‚ CÃ³digo          â”‚ NOM035                                            â”‚</p>
<p>â”‚ Nombre          â”‚ NOM-035 STPS 2018                                â”‚</p>
<p>â”‚ DescripciÃ³n     â”‚ IdentificaciÃ³n y anÃ¡lisis de factores de riesgo  â”‚</p>
<p>â”‚                 â”‚ psicosocial y evaluaciÃ³n del entorno organizacionalâ”‚</p>
<p>â”‚ Tipo            â”‚ regulatory                                        â”‚</p>
<p>â”‚ PaÃ­s            â”‚ MX                                                â”‚</p>
<p>â”‚ Normativa       â”‚ NOM-035-STPS-2018                                â”‚</p>
<p>â”‚ VersiÃ³n         â”‚ 1.0                                               â”‚</p>
<p>â”‚ Es Base         â”‚ NO                                                â”‚</p>
<p>â”‚ Es Obligatoria  â”‚ SI                                                â”‚</p>
<p>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p>
</code>`<code>
<br>
<p>---</p>
<br>
<h2>ğŸ“Š Hoja 2: "Questions"</h2>
<br>
<h3>Formato de Columnas</h3>
<br>
<p>| # | Columna | Tipo | Obligatorio | Valores Permitidos | DescripciÃ³n |</p>
<p>|---|---------|------|-------------|--------------------|-------------|</p>
<p>| A | NÃºmero | Entero | âœ… | 1, 2, 3, ... | NÃºmero de pregunta (secuencial) |</p>
<p>| B | Dominio | Texto | âœ… | Cualquier texto | DimensiÃ³n o categorÃ­a |</p>
<p>| C | Constructo | Texto | âŒ | Cualquier texto | SubcategorÃ­a o tema |</p>
<p>| D | Tipo | Texto | âœ… | RP, FO, MIXED | Tipo de pregunta |</p>
<p>| E | Pregunta | Texto | âœ… | Cualquier texto | Texto de la pregunta |</p>
<p>| F | Peso | Decimal | âœ… | 0.0 - 1.0 | Peso en el cÃ¡lculo |</p>
<p>| G | Severidad | Decimal | âœ… | 0.0 - 1.0 | Nivel de severidad |</p>
<p>| H | Peso_Personal | Decimal | âœ… | 0.0 - 1.0 | Peso responsabilidad personal |</p>
<p>| I | Peso_Org | Decimal | âœ… | 0.0 - 1.0 | Peso factor organizacional |</p>
<br>
<h3>Tipos de Pregunta</h3>
<br>
<ul>
<li><strong>RP</strong> (Responsabilidad Personal): Depende del individuo</li>
<li><strong>FO</strong> (Factor Organizacional): Depende de la organizaciÃ³n</li>
<li><strong>MIXED</strong>: CombinaciÃ³n de ambos</li>
</ul>
<br>
<h3>Ejemplo de Datos</h3>
<br>
</code>`<code>
<p>â”Œâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</p>
<p>â”‚ # â”‚ Dominio     â”‚ Constructo       â”‚ Tipo â”‚ Pregunta                       â”‚ Peso â”‚ Severidadâ”‚ Peso_Personalâ”‚ Peso_Orgâ”‚</p>
<p>â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</p>
<p>â”‚ 1 â”‚ FÃ­sico      â”‚ Bienestar bÃ¡sico â”‚ RP   â”‚ Â¿DormÃ­s lo suficiente?         â”‚ 0.6  â”‚ 0.9      â”‚ 1.0          â”‚ 0.0     â”‚</p>
<p>â”‚ 2 â”‚ FÃ­sico      â”‚ Bienestar bÃ¡sico â”‚ FO   â”‚ Â¿Tu jornada permite descanso?  â”‚ 0.6  â”‚ 0.9      â”‚ 0.0          â”‚ 1.0     â”‚</p>
<p>â”‚ 3 â”‚ FÃ­sico      â”‚ Cuidado diario   â”‚ RP   â”‚ Â¿Te movÃ©s durante la jornada?  â”‚ 0.4  â”‚ 0.8      â”‚ 1.0          â”‚ 0.0     â”‚</p>
<p>â”‚ 4 â”‚ FÃ­sico      â”‚ Cuidado diario   â”‚ FO   â”‚ Â¿Hay espacios para pausas?     â”‚ 0.4  â”‚ 0.8      â”‚ 0.0          â”‚ 1.0     â”‚</p>
<p>â”‚ 5 â”‚ Emocional   â”‚ GestiÃ³n emocionalâ”‚ RP   â”‚ Â¿ManejÃ¡s bien el estrÃ©s?       â”‚ 0.7  â”‚ 0.9      â”‚ 1.0          â”‚ 0.0     â”‚</p>
<p>â”‚ 6 â”‚ Emocional   â”‚ GestiÃ³n emocionalâ”‚ FO   â”‚ Â¿Hay apoyo emocional?          â”‚ 0.7  â”‚ 0.9      â”‚ 0.0          â”‚ 1.0     â”‚</p>
<p>â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p>
</code>`<code>
<br>
<p>---</p>
<br>
<h2>ğŸ“Š Hoja 3: "Algorithm"</h2>
<br>
<h3>Formato JSON</h3>
<br>
<p>Esta hoja contiene <strong>una sola celda</strong> (A1) con un JSON que define el algoritmo de cÃ¡lculo.</p>
<br>
<h3>Estructura del JSON</h3>
<br>
</code>`<code>json
<p>{</p>
<p>  "scoring_method": "weighted_average",</p>
<p>  "domains": [</p>
<p>    {</p>
<p>      "name": "FÃ­sico",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [1, 2, 3, 4, 5, 6]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Emocional",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [7, 8, 9, 10, 11, 12]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Social",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [13, 14, 15, 16, 17, 18]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Profesional",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [19, 20, 21, 22, 23, 24]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Intelectual",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [25, 26, 27, 28, 29, 30]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Financiero",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [31, 32, 33, 34, 35, 36]</p>
<p>    }</p>
<p>  ],</p>
<p>  "thresholds": {</p>
<p>    "low": 0,</p>
<p>    "medium": 5,</p>
<p>    "high": 7,</p>
<p>    "excellent": 9</p>
<p>  },</p>
<p>  "recommendations": {</p>
<p>    "low": "Requiere atenciÃ³n urgente",</p>
<p>    "medium": "Ãrea de oportunidad",</p>
<p>    "high": "Buen nivel, mantener",</p>
<p>    "excellent": "Excelente, ejemplo a seguir"</p>
<p>  }</p>
<p>}</p>
</code>`<code>
<br>
<h3>Campos del Algoritmo</h3>
<br>
<p>| Campo | Tipo | DescripciÃ³n |</p>
<p>|-------|------|-------------|</p>
<p>| </code>scoring_method<code> | String | MÃ©todo de cÃ¡lculo: "weighted_average", "sum", "custom" |</p>
<p>| </code>domains<code> | Array | Lista de dominios con sus configuraciones |</p>
<p>| </code>domains[].name<code> | String | Nombre del dominio (debe coincidir con hoja Questions) |</p>
<p>| </code>domains[].weight<code> | Number | Peso del dominio en el cÃ¡lculo global (0.0 - 1.0) |</p>
<p>| </code>domains[].questions<code> | Array | NÃºmeros de preguntas que pertenecen a este dominio |</p>
<p>| </code>thresholds<code> | Object | Umbrales para clasificaciÃ³n de puntajes |</p>
<p>| </code>recommendations<code> | Object | Mensajes segÃºn nivel de puntaje |</p>
<br>
<p>---</p>
<br>
<h2>âœ… Validaciones AutomÃ¡ticas</h2>
<br>
<p>El sistema validarÃ¡ automÃ¡ticamente:</p>
<br>
<h3>Validaciones de Metadata</h3>
<br>
<ul>
<li>âœ… CÃ³digo Ãºnico (no existe otra encuesta con ese cÃ³digo)</li>
<li>âœ… CÃ³digo sin espacios ni caracteres especiales</li>
<li>âœ… Tipo vÃ¡lido (base, regulatory, custom)</li>
<li>âœ… PaÃ­s en formato ISO (2 letras)</li>
<li>âœ… VersiÃ³n en formato X.Y</li>
<li>âœ… Solo una encuesta puede ser "Base"</li>
</ul>
<br>
<h3>Validaciones de Questions</h3>
<br>
<ul>
<li>âœ… NÃºmeros secuenciales (1, 2, 3, ...)</li>
<li>âœ… Sin nÃºmeros duplicados</li>
<li>âœ… Tipo vÃ¡lido (RP, FO, MIXED)</li>
<li>âœ… Pesos entre 0.0 y 1.0</li>
<li>âœ… Suma de Peso_Personal + Peso_Org = 1.0</li>
<li>âœ… Texto de pregunta no vacÃ­o</li>
<li>âœ… Dominio no vacÃ­o</li>
</ul>
<br>
<h3>Validaciones de Algorithm</h3>
<br>
<ul>
<li>âœ… JSON vÃ¡lido</li>
<li>âœ… Todos los dominios existen en Questions</li>
<li>âœ… Todas las preguntas estÃ¡n asignadas a un dominio</li>
<li>âœ… No hay preguntas duplicadas en dominios</li>
<li>âœ… Suma de weights de dominios = nÃºmero de dominios (si weighted_average)</li>
<li>âœ… Thresholds en orden ascendente</li>
</ul>
<br>
<p>---</p>
<br>
<h2>âŒ Errores Comunes</h2>
<br>
<h3>Error 1: CÃ³digo Duplicado</h3>
<br>
</code>`<code>
<p>âŒ ERROR: El cÃ³digo "NOM035" ya existe en el sistema.</p>
<p>   SoluciÃ³n: Usar un cÃ³digo diferente o incrementar versiÃ³n.</p>
</code>`<code>
<br>
<h3>Error 2: Pregunta sin Dominio</h3>
<br>
</code>`<code>
<p>âŒ ERROR: Pregunta #15 no tiene dominio asignado.</p>
<p>   SoluciÃ³n: Completar la columna "Dominio" en la fila 15.</p>
</code>`<code>
<br>
<h3>Error 3: Pesos Incorrectos</h3>
<br>
</code>`<code>
<p>âŒ ERROR: Pregunta #8 - Peso_Personal (0.6) + Peso_Org (0.6) â‰  1.0</p>
<p>   SoluciÃ³n: Ajustar los pesos para que sumen exactamente 1.0</p>
</code>`<code>
<br>
<h3>Error 4: JSON InvÃ¡lido</h3>
<br>
</code>`<code>
<p>âŒ ERROR: El algoritmo no es un JSON vÃ¡lido.</p>
<p>   LÃ­nea 5: Falta coma despuÃ©s de "weight": 1.0</p>
<p>   SoluciÃ³n: Validar JSON en jsonlint.com</p>
</code>`<code>
<br>
<h3>Error 5: Pregunta No Asignada</h3>
<br>
</code>`<code>
<p>âŒ ERROR: Pregunta #23 no estÃ¡ asignada a ningÃºn dominio en el algoritmo.</p>
<p>   SoluciÃ³n: Agregar el nÃºmero 23 al array "questions" de un dominio.</p>
</code>`<code>
<br>
<p>---</p>
<br>
<h2>ğŸ“ Ejemplo Completo: NOM-035</h2>
<br>
<h3>Archivo: </code>NOM035_v1.0.xlsx<code></h3>
<br>
<h4>Metadata</h4>
</code>`<code>
<p>CÃ³digo: NOM035</p>
<p>Nombre: NOM-035 STPS 2018</p>
<p>DescripciÃ³n: Factores de riesgo psicosocial en el trabajo</p>
<p>Tipo: regulatory</p>
<p>PaÃ­s: MX</p>
<p>Normativa: NOM-035-STPS-2018</p>
<p>VersiÃ³n: 1.0</p>
<p>Es Base: NO</p>
<p>Es Obligatoria: SI</p>
</code>`<code>
<br>
<h4>Questions (primeras 6 de 72)</h4>
</code>`<code>
<p>1 | Condiciones ambiente | IluminaciÃ³n      | FO | Â¿La iluminaciÃ³n es adecuada?           | 0.5 | 0.7 | 0.0 | 1.0</p>
<p>2 | Condiciones ambiente | Temperatura      | FO | Â¿La temperatura es confortable?        | 0.5 | 0.7 | 0.0 | 1.0</p>
<p>3 | Condiciones ambiente | Ruido            | FO | Â¿El ruido permite concentraciÃ³n?       | 0.6 | 0.8 | 0.0 | 1.0</p>
<p>4 | Carga de trabajo     | Volumen          | FO | Â¿El volumen de trabajo es razonable?   | 0.8 | 0.9 | 0.0 | 1.0</p>
<p>5 | Carga de trabajo     | Ritmo            | FO | Â¿El ritmo de trabajo es sostenible?    | 0.8 | 0.9 | 0.0 | 1.0</p>
<p>6 | Carga de trabajo     | AutonomÃ­a        | RP | Â¿Tienes control sobre tu trabajo?      | 0.7 | 0.8 | 1.0 | 0.0</p>
</code>`<code>
<br>
<h4>Algorithm</h4>
</code>`<code>json
<p>{</p>
<p>  "scoring_method": "weighted_average",</p>
<p>  "domains": [</p>
<p>    {</p>
<p>      "name": "Condiciones ambiente",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Carga de trabajo",</p>
<p>      "weight": 1.2,</p>
<p>      "questions": [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Falta de control",</p>
<p>      "weight": 1.1,</p>
<p>      "questions": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Jornada de trabajo",</p>
<p>      "weight": 1.0,</p>
<p>      "questions": [38, 39, 40, 41, 42, 43, 44, 45]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Interferencia trabajo-familia",</p>
<p>      "weight": 0.9,</p>
<p>      "questions": [46, 47, 48, 49, 50, 51]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Liderazgo",</p>
<p>      "weight": 1.3,</p>
<p>      "questions": [52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]</p>
<p>    },</p>
<p>    {</p>
<p>      "name": "Relaciones en el trabajo",</p>
<p>      "weight": 1.1,</p>
<p>      "questions": [64, 65, 66, 67, 68, 69, 70, 71, 72]</p>
<p>    }</p>
<p>  ],</p>
<p>  "thresholds": {</p>
<p>    "nulo": 0,</p>
<p>    "bajo": 15,</p>
<p>    "medio": 30,</p>
<p>    "alto": 45,</p>
<p>    "muy_alto": 60</p>
<p>  },</p>
<p>  "recommendations": {</p>
<p>    "nulo": "Sin riesgo psicosocial",</p>
<p>    "bajo": "Riesgo bajo - Monitorear",</p>
<p>    "medio": "Riesgo medio - Implementar acciones",</p>
<p>    "alto": "Riesgo alto - Acciones urgentes",</p>
<p>    "muy_alto": "Riesgo muy alto - IntervenciÃ³n inmediata"</p>
<p>  }</p>
<p>}</p>
</code>`<code>
<br>
<p>---</p>
<br>
<h2>ğŸ¯ Mejores PrÃ¡cticas</h2>
<br>
<h3>1. Nomenclatura de CÃ³digos</h3>
<br>
<p>âœ… <strong>Bueno:</strong></p>
<ul>
<li></code>EBI360<code></li>
<li></code>NOM035<code></li>
<li></code>LEY_KARIN<code></li>
<li></code>CLIMA_2025<code></li>
</ul>
<br>
<p>âŒ <strong>Malo:</strong></p>
<ul>
<li></code>nom-035<code> (minÃºsculas)</li>
<li></code>Ley Karin<code> (espacios)</li>
<li></code>NOM 035 STPS<code> (espacios)</li>
<li></code>encuesta_1<code> (poco descriptivo)</li>
</ul>
<br>
<h3>2. OrganizaciÃ³n de Dominios</h3>
<br>
<p>âœ… <strong>Bueno:</strong></p>
<ul>
<li>Agrupar preguntas relacionadas</li>
<li>MÃ¡ximo 6-8 dominios</li>
<li>Nombres claros y descriptivos</li>
</ul>
<br>
<p>âŒ <strong>Malo:</strong></p>
<ul>
<li>Demasiados dominios (>10)</li>
<li>Nombres genÃ©ricos ("CategorÃ­a 1")</li>
<li>Dominios con 1-2 preguntas</li>
</ul>
<br>
<h3>3. Balance de Preguntas</h3>
<br>
<p>âœ… <strong>Bueno:</strong></p>
<ul>
<li>5-10 preguntas por dominio</li>
<li>Balance entre RP y FO</li>
<li>Total 30-80 preguntas</li>
</ul>
<br>
<p>âŒ <strong>Malo:</strong></p>
<ul>
<li>Dominios con 1 pregunta</li>
<li>Solo preguntas RP o solo FO</li>
<li>MÃ¡s de 100 preguntas (fatiga)</li>
</ul>
<br>
<h3>4. Pesos y Severidad</h3>
<br>
<p>âœ… <strong>Bueno:</strong></p>
<ul>
<li>Usar escala completa (0.1 - 1.0)</li>
<li>Diferenciar importancia</li>
<li>Documentar criterios</li>
</ul>
<br>
<p>âŒ <strong>Malo:</strong></p>
<ul>
<li>Todo peso 1.0 (no diferencia)</li>
<li>Valores arbitrarios</li>
<li>Sin justificaciÃ³n</li>
</ul>
<br>
<p>---</p>
<br>
<h2>ğŸ“¥ Descarga de Plantilla</h2>
<br>
<h3>Plantillas Disponibles</h3>
<br>
<ol>
<li><strong>Plantilla BÃ¡sica</strong> - </code>plantilla_encuesta_basica.xlsx<code></li>
<ul>
<li>Estructura mÃ­nima</li>
<li>Ejemplo con 12 preguntas</li>
<li>Ideal para empezar</li>
</ul>
</ol>
<br>
<ol>
<li><strong>Plantilla EBI 360</strong> - </code>plantilla_ebi360.xlsx<code></li>
<ul>
<li>Encuesta base completa</li>
<li>36 preguntas en 6 dominios</li>
<li>Referencia de buenas prÃ¡cticas</li>
</ul>
</ol>
<br>
<ol>
<li><strong>Plantilla NOM-035</strong> - </code>plantilla_nom035.xlsx<code></li>
<ul>
<li>Encuesta regulatoria completa</li>
<li>72 preguntas</li>
<li>Ejemplo de normativa mexicana</li>
</ul>
</ol>
<br>
<p>---</p>
<br>
<h2>ğŸ”„ Proceso de ActualizaciÃ³n</h2>
<br>
<h3>Actualizar Encuesta Existente</h3>
<br>
<ol>
<li><strong>Descargar versiÃ³n actual</strong></li>
<ul>
<li>Exportar desde panel de Super Admin</li>
<li>Archivo: </code>[CODIGO]_v[VERSION_ACTUAL].xlsx<code></li>
</ul>
</ol>
<br>
<ol>
<li><strong>Modificar</strong></li>
<ul>
<li>Hacer cambios necesarios</li>
<li>Incrementar versiÃ³n en Metadata</li>
<li>Validar formato</li>
</ul>
</ol>
<br>
<ol>
<li><strong>Subir nueva versiÃ³n</strong></li>
<ul>
<li>Upload en panel de Super Admin</li>
<li>Sistema detecta versiÃ³n nueva</li>
<li>Crea nueva entrada en BD</li>
</ul>
</ol>
<br>
<ol>
<li><strong>Activar</strong></li>
<ul>
<li>Revisar vista previa</li>
<li>Publicar nueva versiÃ³n</li>
<li>VersiÃ³n anterior queda archivada</li>
</ul>
</ol>
<br>
<h3>Versionado SemÃ¡ntico</h3>
<br>
</code>`<code>
<p>v1.0 - VersiÃ³n inicial</p>
<p>v1.1 - Cambios menores (correcciones, ajustes)</p>
<p>v2.0 - Cambios mayores (nuevas preguntas, dominios)</p>
</code>``
<br>
<p>---</p>
<br>
<h2>ğŸ“ Soporte</h2>
<br>
<p>Si tienes dudas sobre el formato:</p>
<br>
<ol>
<li><strong>Revisar esta guÃ­a</strong></li>
<li><strong>Descargar plantilla de ejemplo</strong></li>
<li><strong>Validar en el sistema</strong> (te mostrarÃ¡ errores especÃ­ficos)</li>
<li><strong>Contactar soporte:</strong> tech@ebi360.com</li>
</ol>
<br>
<p>---</p>
<br>
<strong>Ãšltima actualizaciÃ³n:</strong> Diciembre 2025  
<strong>VersiÃ³n de la guÃ­a:</strong> 1.0
<br>
        </div>
        
        <div class="footer">
            <p><strong>Â© 2025 EBI 360</strong> - Todos los derechos reservados</p>
            <p>Documento generado el 23 de December de 2025</p>
        </div>
    </div>
    
    <script>
        window.addEventListener('beforeprint', () => {
            document.title = 'Formato Excel para Encuestas';
        });
    </script>
</body>
</html>